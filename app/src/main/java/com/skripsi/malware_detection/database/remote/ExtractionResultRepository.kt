package com.skripsi.malware_detection.database.remote

import com.skripsi.malware_detection.database.local.entity.ExtractionResultEntity
import com.skripsi.malware_detection.database.local.room.ExtractionResultDao
import com.skripsi.malware_detection.database.remote.retrofit.ExtractionResultApiService

class ExtractionResultRepository private constructor(
    private val extractionResultApiService: ExtractionResultApiService,
    private val extractionResultDao: ExtractionResultDao
){
    suspend fun getExtractionResult(task_id: String) = extractionResultApiService.getExtractionResult(task_id)

    suspend fun insertExtractionResult(res: ExtractionResultEntity) = extractionResultDao.insertResult(res)

    fun getExtractionResultRoom(eid: String) = extractionResultDao.getExtractionResult(eid)

    suspend fun deleteExtractionResult(eid: String) = extractionResultDao.deleteExtractionResult(eid)

    companion object{
        @Volatile
        private var instance: ExtractionResultRepository? = null

        fun getInstance(
            extractionResultApiService: ExtractionResultApiService,
            extractionResultDao: ExtractionResultDao
        ): ExtractionResultRepository =
            instance ?: synchronized(this){
                instance ?: ExtractionResultRepository(extractionResultApiService, extractionResultDao)
            }.also { instance = it }
    }
}