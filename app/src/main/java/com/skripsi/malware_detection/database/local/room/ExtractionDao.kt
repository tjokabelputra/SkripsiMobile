package com.skripsi.malware_detection.database.local.room

import androidx.lifecycle.LiveData
import androidx.room.Dao
import androidx.room.Insert
import androidx.room.OnConflictStrategy
import androidx.room.Query
import com.skripsi.malware_detection.database.local.entity.ExtractionEntity
import java.util.concurrent.Flow

@Dao
interface ExtractionDao {
    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertExtraction(status: ExtractionEntity)

    @Query("SELECT * FROM `extraction` ORDER BY timestamp DESC")
    fun getAllExtractions(): LiveData<List<ExtractionEntity>>

    @Query("SELECT * FROM extraction WHERE status = 'processing'")
    suspend fun getProcessingStatusOnce(): List<ExtractionEntity>

    @Query("UPDATE `extraction` SET status = :status WHERE eid = :eid")
    suspend fun updateExtractionStatus(eid: String, status: String): Int

    @Query("DELETE FROM `extraction` WHERE eid = :eid")
    suspend fun deleteExtractionResult(eid: String)
}